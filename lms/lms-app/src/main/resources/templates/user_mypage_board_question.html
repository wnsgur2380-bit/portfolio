<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout}">

<head>
	<title>마이페이지 - 내 질문</title>
</head>

<body>
	<th:block layout:fragment="content">

		<div class="container my-4">
			<div class="row g-4">
				<form th:action="@{/question/my}" method="get" id="searchForm">
					<input type="hidden" id="page" name="page" th:value="${paging.number}">
				</form>
				<div class="col-lg-3">
					<h4 class="mb-3 fw-bold">마이페이지</h4>
					<div class="list-group">
						<a th:href="@{/enrollment/user(status='active')}"
							class="list-group-item list-group-item-action">신청강좌</a>
						<a th:href="@{/enrollment/user(status='completed')}"
							class="list-group-item list-group-item-action">완료강좌</a>

						<a th:href="@{/question/my}" class="list-group-item list-group-item-action active"
							aria-current="true">내 질문</a>
						<a th:href="@{/answer/my}" class="list-group-item list-group-item-action">내 답글</a>

						<a th:href="@{/user/modify}" class="list-group-item list-group-item-action">내 정보 수정</a>
						<a th:href="@{/api/payments/membership}"
							class="list-group-item list-group-item-action text-warning" th:if="${!user.isPaid}">
							<i class="bi bi-credit-card me-2"></i>멤버십 업그레이드
						</a>
					</div>
				</div>

				<div class="col-lg-9">

					<h4 class="mb-3 fw-bold">내 질문 목록</h4>

					<table class="table table-hover text-center align-middle">
						<thead class="table-light">
							<tr>
								<th scope="col" style="width: 10%;">번호</th>
								<th scope="col" style="width: 20%;">강의명</th>
								<th scope="col" style="width: 15%;">강의 레벨</th>
								<th scope="col" style="width: 30%;">제목</th>
								<th scope="col" style="width: 10%;">작성일</th>
								<th scope="col" style="width: 15%;">답변상태</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="question, loop : ${paging}">
								<th scope="row" th:text="${loop.count}">1</th>

								<td th:text="${question.classes.title}"></td>

								<td>
									<span class="badge" th:text="${question.classes.level?.levelName ?: 'N/A'}"
										th:classappend="${question.classes.level == null ? 'bg-secondary' : 
					                                                           (question.classes.level.levelId == 1 ? 'bg-info' : 
					                                                           (question.classes.level.levelId == 2 ? 'bg-primary' : 'bg-danger'))}">
									</span>
								</td>

								<td class="text-start"> <a th:href="@{|/question/detail/${question.boardQuesId}|}"
										th:text="${question.title}" class="text-decoration-none">
									</a>
									<span th:if="${#lists.size(question.answers) > 0}"
										th:text="|(${#lists.size(question.answers)})|"
										class="text-danger ms-1 fw-bold"></span>
								</td>

								<td th:text="${#temporals.format(question.quesDate, 'YYYY/MM/dd hh:ss')}">10-30</td>

								<td>
									<span th:if="${!#lists.isEmpty(question.answers)}"
										class="badge bg-success">답변완료</span>
									<span th:if="${#lists.isEmpty(question.answers)}"
										class="badge bg-secondary">대기중</span>
								</td>
							</tr>
						</tbody>
					</table>

					<div th:if="${#lists.isEmpty(questionList)}" class="text-center p-5">
						<span class="text-muted">작성한 질문이 없습니다.</span>
					</div>

					<div th:replace="~{pagination :: paging(${paging})}"></div>

				</div>
			</div>
		</div>
	</th:block>
</body>

</html>